<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="report1" language="groovy" pageWidth="822" pageHeight="570" orientation="Landscape" columnWidth="822" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" uuid="66a1df0b-120a-4b6e-851e-7e828c99a2c8">
	<property name="ireport.zoom" value="1.5"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="WebFarma"/>
	<style name="table">
		<box>
			<pen lineWidth="1.0" lineColor="#000000"/>
		</box>
	</style>
	<style name="table_TH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="table_CH" mode="Opaque" backcolor="#BFE1FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="table_TD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="table 1">
		<box>
			<pen lineWidth="1.0" lineColor="#000000"/>
		</box>
	</style>
	<style name="table 1_TH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="table 1_CH" mode="Opaque" backcolor="#BFE1FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="table 1_TD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<queryString>
		<![CDATA[select
 sp.scladproduct,
 p.name as product,
 c.name as color,
 d.nomer as docnomer,
 aa.name as agent1,
 d.dates as docdates,
 (decode (d.vid, 1, 'Поставка', 3, 'Деление')) as docvid,
 dj.status as docstatus,
 dj.pasport as docpasport,
 s1.name as docsclad,
 sp.passport as passsclad,
 s2.name as scladsclad,
 ( decode(sp.status, 0, 'Не пр.', 1, 'На скл.', 2, 'В раб.', 3, 'Ц.раск', 4, 'Бейка' )) as gde,
 (case sp.status when 2 then ( coalesce( (
        select  'Задача №' || z.nomer || ' от ' || z.dates  from zadachascladproduct zp
         inner join zadacha z on z.zadacha = zp.zadacha
         where zp.scladproduct = sp.scladproduct),(
        --union
        select 'Задача №' || z.nomer || ' от ' || z.dates  from zadachadopscladproduct zp
         inner join zadacha z on z.zadacha = zp.zadacha
         where zp.scladproduct = sp.scladproduct),(
        --union
        select 'Списание ' || a.name || ' от ' || dr.dates from documentreturn dr
         inner join agent a on a.agent = dr.agent
         where dr.scladproduct = sp.scladproduct),(
        --union
        select 'Возврат ' || dr1.nomer || ' от ' || dr1.dates from doc_return_journal drj
         inner join doc_return dr1 on dr1.doc_return = drj.doc_return
         where drj.scladproduct = sp.scladproduct),'Ревизия')

     ) else '' end) as dels

from scladproduct  sp
inner join documentjournal dj on sp.documentjournal = dj.documentjournal
inner join document d on d.document = dj.document
inner join sclad s1 on dj.sclad = s1.sclad
inner join sclad s2 on sp.sclad = s2.sclad
inner join product p on sp.product = p.product
inner join color c on c.color = sp.color
inner join agent aa on aa.agent = d.agent
where sp.vid = 1
order by  sp.passport]]>
	</queryString>
	<field name="SCLADPRODUCT" class="java.lang.Integer"/>
	<field name="PRODUCT" class="java.lang.String"/>
	<field name="COLOR" class="java.lang.String"/>
	<field name="DOCNOMER" class="java.lang.String"/>
	<field name="AGENT1" class="java.lang.String"/>
	<field name="DOCDATES" class="java.sql.Date"/>
	<field name="DOCVID" class="java.lang.String"/>
	<field name="DOCSTATUS" class="java.lang.Integer"/>
	<field name="DOCPASPORT" class="java.lang.String"/>
	<field name="DOCSCLAD" class="java.lang.String"/>
	<field name="PASSSCLAD" class="java.lang.String"/>
	<field name="SCLADSCLAD" class="java.lang.String"/>
	<field name="GDE" class="java.lang.String"/>
	<field name="DELS" class="java.lang.String"/>
	<variable name="lines" class="java.lang.Integer" calculation="Count">
		<variableExpression><![CDATA[$F{SCLADPRODUCT}]]></variableExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="44"/>
	</title>
	<pageHeader>
		<band height="25"/>
	</pageHeader>
	<columnHeader>
		<band height="18">
			<staticText>
				<reportElement x="43" y="0" width="182" height="18" uuid="7d754a23-ee09-4a02-b844-969feb5d7eb8"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="10" pdfFontName="arial.ttf" pdfEncoding="Cp1251"/>
				</textElement>
				<text><![CDATA[Полотно]]></text>
			</staticText>
			<staticText>
				<reportElement x="225" y="0" width="88" height="18" uuid="ac81d72d-d6d8-4396-a2d8-15121ec2586b"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="10" pdfFontName="arial.ttf" pdfEncoding="Cp1251"/>
				</textElement>
				<text><![CDATA[Цвет]]></text>
			</staticText>
			<staticText>
				<reportElement x="313" y="0" width="50" height="18" uuid="9ab389c0-90cd-49db-ac1d-fb9545f8f7a2"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="10" pdfFontName="arial.ttf" pdfEncoding="Cp1251"/>
				</textElement>
				<text><![CDATA[Поставщик]]></text>
			</staticText>
			<staticText>
				<reportElement x="363" y="0" width="50" height="18" uuid="d233a693-ca48-4edd-8945-88267d78a1b8"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="10" pdfFontName="arial.ttf" pdfEncoding="Cp1251"/>
				</textElement>
				<text><![CDATA[Номер]]></text>
			</staticText>
			<staticText>
				<reportElement x="413" y="0" width="50" height="18" uuid="8428d376-41be-40ab-b56b-c6bfefa25c37"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<text><![CDATA[Дата]]></text>
			</staticText>
			<staticText>
				<reportElement x="463" y="0" width="50" height="18" uuid="207cc81c-e560-4ff2-9f5d-148602954065"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<text><![CDATA[Паспорт]]></text>
			</staticText>
			<staticText>
				<reportElement x="513" y="0" width="50" height="18" uuid="aa7d1f9c-6dce-41f4-a744-bfaa9b76189c"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<text><![CDATA[Хран.]]></text>
			</staticText>
			<staticText>
				<reportElement x="563" y="0" width="33" height="18" uuid="21b1539c-dc36-4503-8530-6999dd8636e7"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<text><![CDATA[Место]]></text>
			</staticText>
			<staticText>
				<reportElement x="596" y="0" width="206" height="18" uuid="bd6f78dc-213d-4202-b93f-29f4ef68f7da"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<text><![CDATA[История]]></text>
			</staticText>
			<staticText>
				<reportElement x="15" y="0" width="28" height="18" uuid="62fd40f0-fbaa-4a71-ac9c-957adb52f143"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<text><![CDATA[№]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="14" splitType="Stretch">
			<textField>
				<reportElement x="43" y="0" width="182" height="14" uuid="68630cb1-f9d6-48de-b395-df7a9a58ba6e"/>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="8" pdfFontName="arial.ttf" pdfEncoding="Cp1251"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{PRODUCT}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="225" y="0" width="88" height="14" uuid="cec8d223-a428-4e13-9011-ec5b62e40aac"/>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="8" pdfFontName="arial.ttf" pdfEncoding="Cp1251"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{COLOR}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement x="313" y="0" width="50" height="14" uuid="4411cf1b-f932-4ebd-9cad-9ec5d2886a73"/>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="8" pdfFontName="arial.ttf" pdfEncoding="Cp1251"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{AGENT1}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement x="363" y="0" width="50" height="14" uuid="703fd23c-19b1-492c-af57-247d3ea3a170"/>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8" pdfFontName="arial.ttf" pdfEncoding="Cp1251"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{DOCNOMER}]]></textFieldExpression>
			</textField>
			<textField pattern="dd-MM-yyyy">
				<reportElement x="413" y="0" width="50" height="14" uuid="390f0c9d-525d-4dd9-9fee-00d5637343ad"/>
				<box rightPadding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{DOCDATES}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement x="463" y="0" width="50" height="14" uuid="fc138e61-b231-42cc-aad5-5798cddeb185"/>
				<box leftPadding="2" rightPadding="0">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{PASSSCLAD}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement x="513" y="0" width="50" height="14" uuid="10ad7aa3-600c-448f-aa71-a75a71933bea"/>
				<box leftPadding="2" rightPadding="0">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{SCLADSCLAD}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement x="563" y="0" width="33" height="14" uuid="9d65b4c5-96c1-4ddf-b56a-6e27ffc73124"/>
				<box rightPadding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{GDE}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement x="596" y="0" width="206" height="14" uuid="cac79a17-6d2d-4054-824f-8c23ac13f9cc"/>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{DELS}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="15" y="0" width="28" height="14" uuid="49980c73-9f5d-4864-a1a4-bd4814d796ea"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{lines}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<pageFooter>
		<band height="18"/>
	</pageFooter>
	<summary>
		<band height="50"/>
	</summary>
</jasperReport>
