<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="report1" language="groovy" printOrder="Horizontal" pageWidth="595" pageHeight="842" columnWidth="570" leftMargin="15" rightMargin="10" topMargin="10" bottomMargin="10" uuid="66a1df0b-120a-4b6e-851e-7e828c99a2c8">
	<property name="ireport.zoom" value="2.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="WebFarma"/>
	<parameter name="chex" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[0]]></defaultValueExpression>
	</parameter>
	<parameter name="rabotnik" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[0]]></defaultValueExpression>
	</parameter>
	<parameter name="date1" class="java.util.Date">
		<defaultValueExpression><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<parameter name="date2" class="java.util.Date">
		<defaultValueExpression><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<parameter name="oper" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[1]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[select
  r.name,
  sum(ro.summaall),
  (select k.name from rabotnik k where k.rabotnik = $P{rabotnik} ) as rabname,
  (select g.name from rabotnikgruppa g where g.rabotnikgruppa =  $P{chex}) as chexname
from rabotnikoperation ro
inner join rabotnik r on r.rabotnik = ro.rabotnik
where ro.chex = (case $P{chex} when 0 then ro.chex else $P{chex} end)
and r.rabotnik = (case $P{rabotnik} when 0 then r.rabotnik else $P{rabotnik} end)
and ro.dates between $P{date1}  and $P{date2}
and ro.chex not in (case (select nochex from operator where operator = $P{oper}) when 0 then -1 else (select chex from OPERATORCHEXSTOP where operator = $P{oper}) end)
group by r.name
order by 1]]>
	</queryString>
	<field name="NAME" class="java.lang.String"/>
	<field name="SUM" class="java.math.BigDecimal"/>
	<field name="RABNAME" class="java.lang.String"/>
	<field name="CHEXNAME" class="java.lang.String"/>
	<variable name="lines" class="java.lang.Integer" calculation="Count">
		<variableExpression><![CDATA[$F{NAME}]]></variableExpression>
		<initialValueExpression><![CDATA[$F{NAME}]]></initialValueExpression>
	</variable>
	<variable name="SUM_1" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{SUM}]]></variableExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="55">
			<staticText>
				<reportElement x="18" y="0" width="205" height="15" uuid="01f6bc52-9b76-4602-b61e-27aad26d623c"/>
				<box>
					<bottomPen lineWidth="0.25"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font isBold="true" pdfFontName="arial.ttf" pdfEncoding="Cp1251"/>
				</textElement>
				<text><![CDATA[Учет рабочего времени швейного цеха с]]></text>
			</staticText>
			<textField pattern="dd-MM-yyyy">
				<reportElement x="223" y="0" width="70" height="15" uuid="88076159-ea9f-4df6-9ae6-8637d8383af7"/>
				<box>
					<bottomPen lineWidth="0.25"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font isBold="true" pdfFontName="arial.ttf" pdfEncoding="Cp1251"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{date1}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="293" y="0" width="15" height="15" uuid="fa83944b-18d8-455d-a84d-403620c64160"/>
				<box>
					<bottomPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true" pdfFontName="arial.ttf" pdfEncoding="Cp1251"/>
				</textElement>
				<text><![CDATA[по]]></text>
			</staticText>
			<textField pattern="dd-MM-yyyy">
				<reportElement x="308" y="0" width="100" height="15" uuid="b46e1b41-ca98-4b37-a9ed-47aba7679712"/>
				<box>
					<bottomPen lineWidth="0.25"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font isBold="true" pdfFontName="arial.ttf" pdfEncoding="Cp1251"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{date2}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="18" y="15" width="60" height="17" uuid="076c9257-c1fa-46af-b73f-95d434b4df4e"/>
				<box>
					<bottomPen lineWidth="0.25"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font pdfFontName="arial.ttf" pdfEncoding="Cp1251"/>
				</textElement>
				<text><![CDATA[Цех]]></text>
			</staticText>
			<textField>
				<reportElement x="78" y="15" width="183" height="17" uuid="0eced768-3ed8-472b-9883-54f7bf602084"/>
				<box>
					<bottomPen lineWidth="0.25"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font pdfFontName="arial.ttf" pdfEncoding="Cp1251"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{CHEXNAME}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="18" y="32" width="60" height="15" uuid="8589e5d9-a19b-4ccf-9038-29c0b457ae59"/>
				<box>
					<bottomPen lineWidth="0.25"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font pdfFontName="arial.ttf" pdfEncoding="Cp1251"/>
				</textElement>
				<text><![CDATA[Работник]]></text>
			</staticText>
			<textField>
				<reportElement x="78" y="32" width="183" height="15" uuid="7f88ae97-eff4-4618-b427-f1c2a2a52519"/>
				<box>
					<bottomPen lineWidth="0.25"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font pdfFontName="arial.ttf" pdfEncoding="Cp1251"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{RABNAME}]]></textFieldExpression>
			</textField>
		</band>
	</title>
	<pageHeader>
		<band height="22"/>
	</pageHeader>
	<columnHeader>
		<band height="18"/>
	</columnHeader>
	<detail>
		<band height="18">
			<textField pattern="#,##0">
				<reportElement x="255" y="0" width="70" height="18" uuid="e38576c9-16ad-4c2c-b4b4-c2a8cb6c6ec7"/>
				<box leftPadding="1" rightPadding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="12" pdfFontName="arial.ttf" pdfEncoding="Cp1251"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{SUM}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="18" y="0" width="25" height="18" uuid="12ae388b-c4e7-4744-9324-06b093d6b49a"/>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="12" pdfFontName="arial.ttf" pdfEncoding="Cp1251"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{lines}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="43" y="0" width="212" height="18" uuid="6a2bd2cc-14d7-4a4a-a90d-70f22ca9e164"/>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="12" pdfFontName="arial.ttf" pdfEncoding="Cp1251"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{NAME}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<pageFooter>
		<band height="16"/>
	</pageFooter>
	<summary>
		<band height="50">
			<staticText>
				<reportElement x="18" y="0" width="237" height="20" uuid="17624f79-2dab-4bf8-ba52-4563e8df6e76"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Итого:]]></text>
			</staticText>
			<textField pattern="#,##0">
				<reportElement x="255" y="0" width="70" height="20" uuid="ad768d92-a56e-4533-bed9-57e3d8b4fd56"/>
				<box rightPadding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUM_1}]]></textFieldExpression>
			</textField>
		</band>
	</summary>
</jasperReport>
